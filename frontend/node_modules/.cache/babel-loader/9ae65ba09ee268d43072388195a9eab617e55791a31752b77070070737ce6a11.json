{"ast":null,"code":"var _jsxFileName = \"/home/james/www/qitmeer/qng_agent/frontend/src/App.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [walletConnected, setWalletConnected] = useState(false);\n  const [walletAddress, setWalletAddress] = useState('');\n  const [currentSession, setCurrentSession] = useState(null);\n  const [signatureRequest, setSignatureRequest] = useState(null);\n  const messagesEndRef = useRef(null);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // ÁúüÂÆûAPIË∞ÉÁî®\n  const API_BASE_URL = 'http://localhost:8080';\n  const MCP_BASE_URL = 'http://localhost:8081';\n  const callAgentAPI = async message => {\n    console.log('üîó Ë∞ÉÁî®Êô∫ËÉΩ‰ΩìAPI:', `${API_BASE_URL}/api/agent/process`);\n    const response = await fetch(`${API_BASE_URL}/api/agent/process`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        message\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`APIË∞ÉÁî®Â§±Ë¥•: ${response.status} ${response.statusText}`);\n    }\n    const data = await response.json();\n    console.log('üì° Êô∫ËÉΩ‰ΩìAPIÂìçÂ∫î:', data);\n    return data;\n  };\n  const pollWorkflowStatus = async sessionId => {\n    console.log('üîÑ ËΩÆËØ¢Â∑•‰ΩúÊµÅÁä∂ÊÄÅ:', sessionId);\n    const response = await fetch(`${API_BASE_URL}/api/agent/poll/${sessionId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    if (!response.ok) {\n      throw new Error(`ËΩÆËØ¢Â§±Ë¥•: ${response.status} ${response.statusText}`);\n    }\n    const data = await response.json();\n    console.log('üìä Â∑•‰ΩúÊµÅÁä∂ÊÄÅ:', data);\n    return data;\n  };\n  const submitSignature = async (sessionId, signature) => {\n    console.log('‚úçÔ∏è Êèê‰∫§Á≠æÂêç:', sessionId);\n    const response = await fetch(`${API_BASE_URL}/api/agent/signature`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        session_id: sessionId,\n        signature: signature\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`Á≠æÂêçÊèê‰∫§Â§±Ë¥•: ${response.status} ${response.statusText}`);\n    }\n    const data = await response.json();\n    console.log('‚úÖ Á≠æÂêçÊèê‰∫§ÂìçÂ∫î:', data);\n    return data;\n  };\n  const connectWallet = async () => {\n    console.log('üîó ËøûÊé•MetaMaskÈí±ÂåÖ...');\n\n    // Ê£ÄÊü•MetaMaskÊòØÂê¶ÂèØÁî®\n    if (typeof window.ethereum === 'undefined') {\n      throw new Error('MetaMaskÊú™ÂÆâË£ÖÔºåËØ∑ÂÖàÂÆâË£ÖMetaMaskÊâ©Â±ï');\n    }\n    try {\n      // ËØ∑Ê±ÇËøûÊé•Èí±ÂåÖ\n      const accounts = await window.ethereum.request({\n        method: 'eth_requestAccounts'\n      });\n\n      // Ëé∑ÂèñÁΩëÁªú‰ø°ÊÅØ\n      const chainId = await window.ethereum.request({\n        method: 'eth_chainId'\n      });\n\n      // Ëé∑Âèñ‰ΩôÈ¢ù\n      const balance = await window.ethereum.request({\n        method: 'eth_getBalance',\n        params: [accounts[0], 'latest']\n      });\n      setWalletConnected(true);\n      setWalletAddress(accounts[0]);\n      console.log('‚úÖ Èí±ÂåÖËøûÊé•ÊàêÂäü:', {\n        address: accounts[0],\n        chainId: chainId,\n        balance: balance\n      });\n      return {\n        connected: true,\n        accounts: accounts,\n        network: 'Ethereum Mainnet',\n        chain_id: chainId,\n        balance: balance\n      };\n    } catch (error) {\n      console.error('‚ùå Èí±ÂåÖËøûÊé•Â§±Ë¥•:', error);\n      throw error;\n    }\n  };\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim()) return;\n    const userMessage = inputMessage;\n    setInputMessage('');\n    setIsLoading(true);\n\n    // Ê∑ªÂä†Áî®Êà∑Ê∂àÊÅØ\n    setMessages(prev => [...prev, {\n      id: Date.now(),\n      type: 'user',\n      content: userMessage,\n      timestamp: new Date()\n    }]);\n    try {\n      // 1. Ë∞ÉÁî®Êô∫ËÉΩ‰ΩìAPI\n      const execution = await callAgentAPI(userMessage);\n      setCurrentSession(execution);\n\n      // Ê∑ªÂä†Á≥ªÁªüÊ∂àÊÅØ\n      setMessages(prev => [...prev, {\n        id: Date.now() + 1,\n        type: 'system',\n        content: 'üîÑ Ê≠£Âú®ÂàÜÊûêÊÇ®ÁöÑËØ∑Ê±Ç...',\n        timestamp: new Date()\n      }]);\n\n      // 2. ËΩÆËØ¢Â∑•‰ΩúÊµÅÁä∂ÊÄÅ\n      let status;\n      let pollCount = 0;\n      const maxPolls = 30; // ÊúÄÂ§öËΩÆËØ¢30Ê¨°\n\n      while (pollCount < maxPolls) {\n        status = await pollWorkflowStatus(execution.session_id);\n        pollCount++;\n        console.log(`üìä Á¨¨${pollCount}Ê¨°ËΩÆËØ¢Áä∂ÊÄÅ:`, status);\n        if (status.status === 'completed' || status.status === 'failed') {\n          break;\n        }\n\n        // Á≠âÂæÖ2ÁßíÂêéÁªßÁª≠ËΩÆËØ¢\n        await new Promise(resolve => setTimeout(resolve, 2000));\n      }\n      if (status.need_signature) {\n        setSignatureRequest(status.signature_request);\n        setMessages(prev => [...prev, {\n          id: Date.now() + 2,\n          type: 'system',\n          content: '‚úçÔ∏è ÈúÄË¶ÅÊÇ®Á≠æÂêçÊéàÊùÉ‰∫§ÊòìÔºåËØ∑ÁÇπÂáª‰∏ãÊñπÊåâÈíÆËøõË°åÁ≠æÂêç',\n          timestamp: new Date(),\n          requiresSignature: true\n        }]);\n      } else if (status.status === 'completed') {\n        setMessages(prev => [...prev, {\n          id: Date.now() + 2,\n          type: 'system',\n          content: '‚úÖ Â∑•‰ΩúÊµÅÊâßË°åÂÆåÊàêÔºÅ',\n          timestamp: new Date()\n        }]);\n      } else if (status.status === 'failed') {\n        setMessages(prev => [...prev, {\n          id: Date.now() + 2,\n          type: 'error',\n          content: `‚ùå Â∑•‰ΩúÊµÅÊâßË°åÂ§±Ë¥•: ${status.error || 'Êú™Áü•ÈîôËØØ'}`,\n          timestamp: new Date()\n        }]);\n      }\n    } catch (error) {\n      console.error('‚ùå Â§ÑÁêÜÂ§±Ë¥•:', error);\n      setMessages(prev => [...prev, {\n        id: Date.now() + 3,\n        type: 'error',\n        content: `‚ùå Â§ÑÁêÜÂ§±Ë¥•: ${error.message}`,\n        timestamp: new Date()\n      }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleSignature = async () => {\n    if (!signatureRequest) return;\n    setIsLoading(true);\n    try {\n      console.log('‚úçÔ∏è ÂºÄÂßãÁ≠æÂêçÊµÅÁ®ã...');\n\n      // ‰ΩøÁî®MetaMaskËøõË°åÁ≠æÂêç\n      if (typeof window.ethereum === 'undefined') {\n        throw new Error('MetaMaskÊú™ÂÆâË£Ö');\n      }\n\n      // ÊûÑÂª∫‰∫§ÊòìÊï∞ÊçÆ\n      const transactionData = {\n        to: signatureRequest.to_address,\n        value: signatureRequest.value || '0x0',\n        data: signatureRequest.data || '0x',\n        gas: signatureRequest.gas_limit || '0x186A0',\n        // 100000 gas\n        gasPrice: signatureRequest.gas_price || '0x3B9ACA00' // 1 gwei\n      };\n      console.log('üìù ‰∫§ÊòìÊï∞ÊçÆ:', transactionData);\n\n      // ËØ∑Ê±ÇÁî®Êà∑Á≠æÂêç\n      const signature = await window.ethereum.request({\n        method: 'eth_sendTransaction',\n        params: [transactionData]\n      });\n      console.log('‚úÖ ‰∫§ÊòìÁ≠æÂêçÊàêÂäü:', signature);\n\n      // Êèê‰∫§Á≠æÂêçÂà∞ÂêéÁ´Ø\n      const result = await submitSignature(currentSession.session_id, signature);\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'system',\n        content: '‚úÖ Á≠æÂêçÂ∑≤Êèê‰∫§Ôºå‰∫§ÊòìÊ≠£Âú®Â§ÑÁêÜ‰∏≠...',\n        timestamp: new Date()\n      }]);\n\n      // ËΩÆËØ¢‰∫§ÊòìÁä∂ÊÄÅ\n      let pollCount = 0;\n      const maxPolls = 20;\n      while (pollCount < maxPolls) {\n        const status = await pollWorkflowStatus(currentSession.session_id);\n        pollCount++;\n        console.log(`üìä Á¨¨${pollCount}Ê¨°ËΩÆËØ¢‰∫§ÊòìÁä∂ÊÄÅ:`, status);\n        if (status.status === 'completed') {\n          setMessages(prev => [...prev, {\n            id: Date.now() + 1,\n            type: 'system',\n            content: `üéâ ‰∫§ÊòìÂÆåÊàêÔºÅ‰∫§ÊòìÂìàÂ∏å: ${signature}`,\n            timestamp: new Date()\n          }]);\n          break;\n        } else if (status.status === 'failed') {\n          setMessages(prev => [...prev, {\n            id: Date.now() + 1,\n            type: 'error',\n            content: `‚ùå ‰∫§ÊòìÂ§±Ë¥•: ${status.error || 'Êú™Áü•ÈîôËØØ'}`,\n            timestamp: new Date()\n          }]);\n          break;\n        }\n\n        // Á≠âÂæÖ3ÁßíÂêéÁªßÁª≠ËΩÆËØ¢\n        await new Promise(resolve => setTimeout(resolve, 3000));\n      }\n      setSignatureRequest(null);\n      setCurrentSession(null);\n    } catch (error) {\n      console.error('‚ùå Á≠æÂêçÂ§±Ë¥•:', error);\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'error',\n        content: `‚ùå Á≠æÂêçÂ§±Ë¥•: ${error.message}`,\n        timestamp: new Date()\n      }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleConnectWallet = async () => {\n    try {\n      await connectWallet();\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'system',\n        content: `üîó Èí±ÂåÖËøûÊé•ÊàêÂäüÔºÅÂú∞ÂùÄ: ${walletAddress}`,\n        timestamp: new Date()\n      }]);\n    } catch (error) {\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'error',\n        content: `‚ùå Èí±ÂåÖËøûÊé•Â§±Ë¥•: ${error.message}`,\n        timestamp: new Date()\n      }]);\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\uD83E\\uDD16 QNG \\u667A\\u80FD\\u4F53\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"wallet-info\",\n        children: walletConnected ? /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"connected\",\n          children: [\"\\uD83D\\uDD17 \", walletAddress.slice(0, 6), \"...\", walletAddress.slice(-4)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"connect-btn\",\n          onClick: handleConnectWallet,\n          disabled: isLoading,\n          children: \"\\uD83D\\uDD17 \\u8FDE\\u63A5\\u94B1\\u5305\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 346,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages\",\n        children: [messages.map(message => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${message.type}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: message.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 361,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-time\",\n            children: message.timestamp.toLocaleTimeString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this)]\n        }, message.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 13\n        }, this)), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message system\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"loading\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u23F3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 373,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"\\u5904\\u7406\\u4E2D\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 374,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 375,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 380,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 9\n      }, this), signatureRequest && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"signature-request\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\u270D\\uFE0F \\u4EA4\\u6613\\u7B7E\\u540D\\u8BF7\\u6C42\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 385,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"signature-details\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u64CD\\u4F5C:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 18\n            }, this), \" \", signatureRequest.action]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u4ECE:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 18\n            }, this), \" \", signatureRequest.from_token]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 388,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u5230:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 18\n            }, this), \" \", signatureRequest.to_token]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u6570\\u91CF:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 18\n            }, this), \" \", signatureRequest.amount]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Gas\\u8D39:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 18\n            }, this), \" \", signatureRequest.gas_fee]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 391,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u6ED1\\u70B9:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 18\n            }, this), \" \", signatureRequest.slippage]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 386,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"signature-btn\",\n          onClick: handleSignature,\n          disabled: isLoading,\n          children: \"\\uD83D\\uDD10 \\u786E\\u8BA4\\u7B7E\\u540D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: inputMessage,\n          onChange: e => setInputMessage(e.target.value),\n          onKeyPress: handleKeyPress,\n          placeholder: \"\\u8F93\\u5165\\u60A8\\u7684\\u8BF7\\u6C42\\uFF0C\\u4F8B\\u5982\\uFF1A\\u6211\\u9700\\u8981\\u5C061000USDT\\u5151\\u6362\\u6210BTC\",\n          disabled: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSendMessage,\n          disabled: isLoading || !inputMessage.trim(),\n          className: \"send-btn\",\n          children: \"\\u53D1\\u9001\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 337,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"Ar45QqRtrLfLbyBNZdwWYl4b/MI=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","jsxDEV","_jsxDEV","App","_s","messages","setMessages","inputMessage","setInputMessage","isLoading","setIsLoading","walletConnected","setWalletConnected","walletAddress","setWalletAddress","currentSession","setCurrentSession","signatureRequest","setSignatureRequest","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","API_BASE_URL","MCP_BASE_URL","callAgentAPI","message","console","log","response","fetch","method","headers","body","JSON","stringify","ok","Error","status","statusText","data","json","pollWorkflowStatus","sessionId","submitSignature","signature","session_id","connectWallet","window","ethereum","accounts","request","chainId","balance","params","address","connected","network","chain_id","error","handleSendMessage","trim","userMessage","prev","id","Date","now","type","content","timestamp","execution","pollCount","maxPolls","Promise","resolve","setTimeout","need_signature","signature_request","requiresSignature","handleSignature","transactionData","to","to_address","value","gas","gas_limit","gasPrice","gas_price","result","handleConnectWallet","handleKeyPress","e","key","shiftKey","preventDefault","className","children","fileName","_jsxFileName","lineNumber","columnNumber","slice","onClick","disabled","map","toLocaleTimeString","ref","action","from_token","to_token","amount","gas_fee","slippage","onChange","target","onKeyPress","placeholder","_c","$RefreshReg$"],"sources":["/home/james/www/qitmeer/qng_agent/frontend/src/App.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport './App.css';\n\nfunction App() {\n  const [messages, setMessages] = useState([]);\n  const [inputMessage, setInputMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [walletConnected, setWalletConnected] = useState(false);\n  const [walletAddress, setWalletAddress] = useState('');\n  const [currentSession, setCurrentSession] = useState(null);\n  const [signatureRequest, setSignatureRequest] = useState(null);\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // ÁúüÂÆûAPIË∞ÉÁî®\n  const API_BASE_URL = 'http://localhost:8080';\n  const MCP_BASE_URL = 'http://localhost:8081';\n\n  const callAgentAPI = async (message) => {\n    console.log('üîó Ë∞ÉÁî®Êô∫ËÉΩ‰ΩìAPI:', `${API_BASE_URL}/api/agent/process`);\n    \n    const response = await fetch(`${API_BASE_URL}/api/agent/process`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ message })\n    });\n\n    if (!response.ok) {\n      throw new Error(`APIË∞ÉÁî®Â§±Ë¥•: ${response.status} ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    console.log('üì° Êô∫ËÉΩ‰ΩìAPIÂìçÂ∫î:', data);\n    return data;\n  };\n\n  const pollWorkflowStatus = async (sessionId) => {\n    console.log('üîÑ ËΩÆËØ¢Â∑•‰ΩúÊµÅÁä∂ÊÄÅ:', sessionId);\n    \n    const response = await fetch(`${API_BASE_URL}/api/agent/poll/${sessionId}`, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      }\n    });\n\n    if (!response.ok) {\n      throw new Error(`ËΩÆËØ¢Â§±Ë¥•: ${response.status} ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    console.log('üìä Â∑•‰ΩúÊµÅÁä∂ÊÄÅ:', data);\n    return data;\n  };\n\n  const submitSignature = async (sessionId, signature) => {\n    console.log('‚úçÔ∏è Êèê‰∫§Á≠æÂêç:', sessionId);\n    \n    const response = await fetch(`${API_BASE_URL}/api/agent/signature`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ \n        session_id: sessionId, \n        signature: signature \n      })\n    });\n\n    if (!response.ok) {\n      throw new Error(`Á≠æÂêçÊèê‰∫§Â§±Ë¥•: ${response.status} ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    console.log('‚úÖ Á≠æÂêçÊèê‰∫§ÂìçÂ∫î:', data);\n    return data;\n  };\n\n  const connectWallet = async () => {\n    console.log('üîó ËøûÊé•MetaMaskÈí±ÂåÖ...');\n    \n    // Ê£ÄÊü•MetaMaskÊòØÂê¶ÂèØÁî®\n    if (typeof window.ethereum === 'undefined') {\n      throw new Error('MetaMaskÊú™ÂÆâË£ÖÔºåËØ∑ÂÖàÂÆâË£ÖMetaMaskÊâ©Â±ï');\n    }\n\n    try {\n      // ËØ∑Ê±ÇËøûÊé•Èí±ÂåÖ\n      const accounts = await window.ethereum.request({ \n        method: 'eth_requestAccounts' \n      });\n      \n      // Ëé∑ÂèñÁΩëÁªú‰ø°ÊÅØ\n      const chainId = await window.ethereum.request({ \n        method: 'eth_chainId' \n      });\n      \n      // Ëé∑Âèñ‰ΩôÈ¢ù\n      const balance = await window.ethereum.request({\n        method: 'eth_getBalance',\n        params: [accounts[0], 'latest']\n      });\n\n      setWalletConnected(true);\n      setWalletAddress(accounts[0]);\n      \n      console.log('‚úÖ Èí±ÂåÖËøûÊé•ÊàêÂäü:', {\n        address: accounts[0],\n        chainId: chainId,\n        balance: balance\n      });\n      \n      return {\n        connected: true,\n        accounts: accounts,\n        network: 'Ethereum Mainnet',\n        chain_id: chainId,\n        balance: balance\n      };\n    } catch (error) {\n      console.error('‚ùå Èí±ÂåÖËøûÊé•Â§±Ë¥•:', error);\n      throw error;\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputMessage.trim()) return;\n\n    const userMessage = inputMessage;\n    setInputMessage('');\n    setIsLoading(true);\n\n    // Ê∑ªÂä†Áî®Êà∑Ê∂àÊÅØ\n    setMessages(prev => [...prev, {\n      id: Date.now(),\n      type: 'user',\n      content: userMessage,\n      timestamp: new Date()\n    }]);\n\n    try {\n      // 1. Ë∞ÉÁî®Êô∫ËÉΩ‰ΩìAPI\n      const execution = await callAgentAPI(userMessage);\n      setCurrentSession(execution);\n\n      // Ê∑ªÂä†Á≥ªÁªüÊ∂àÊÅØ\n      setMessages(prev => [...prev, {\n        id: Date.now() + 1,\n        type: 'system',\n        content: 'üîÑ Ê≠£Âú®ÂàÜÊûêÊÇ®ÁöÑËØ∑Ê±Ç...',\n        timestamp: new Date()\n      }]);\n\n      // 2. ËΩÆËØ¢Â∑•‰ΩúÊµÅÁä∂ÊÄÅ\n      let status;\n      let pollCount = 0;\n      const maxPolls = 30; // ÊúÄÂ§öËΩÆËØ¢30Ê¨°\n      \n      while (pollCount < maxPolls) {\n        status = await pollWorkflowStatus(execution.session_id);\n        pollCount++;\n        \n        console.log(`üìä Á¨¨${pollCount}Ê¨°ËΩÆËØ¢Áä∂ÊÄÅ:`, status);\n        \n        if (status.status === 'completed' || status.status === 'failed') {\n          break;\n        }\n        \n        // Á≠âÂæÖ2ÁßíÂêéÁªßÁª≠ËΩÆËØ¢\n        await new Promise(resolve => setTimeout(resolve, 2000));\n      }\n      \n      if (status.need_signature) {\n        setSignatureRequest(status.signature_request);\n        setMessages(prev => [...prev, {\n          id: Date.now() + 2,\n          type: 'system',\n          content: '‚úçÔ∏è ÈúÄË¶ÅÊÇ®Á≠æÂêçÊéàÊùÉ‰∫§ÊòìÔºåËØ∑ÁÇπÂáª‰∏ãÊñπÊåâÈíÆËøõË°åÁ≠æÂêç',\n          timestamp: new Date(),\n          requiresSignature: true\n        }]);\n      } else if (status.status === 'completed') {\n        setMessages(prev => [...prev, {\n          id: Date.now() + 2,\n          type: 'system',\n          content: '‚úÖ Â∑•‰ΩúÊµÅÊâßË°åÂÆåÊàêÔºÅ',\n          timestamp: new Date()\n        }]);\n      } else if (status.status === 'failed') {\n        setMessages(prev => [...prev, {\n          id: Date.now() + 2,\n          type: 'error',\n          content: `‚ùå Â∑•‰ΩúÊµÅÊâßË°åÂ§±Ë¥•: ${status.error || 'Êú™Áü•ÈîôËØØ'}`,\n          timestamp: new Date()\n        }]);\n      }\n\n    } catch (error) {\n      console.error('‚ùå Â§ÑÁêÜÂ§±Ë¥•:', error);\n      setMessages(prev => [...prev, {\n        id: Date.now() + 3,\n        type: 'error',\n        content: `‚ùå Â§ÑÁêÜÂ§±Ë¥•: ${error.message}`,\n        timestamp: new Date()\n      }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSignature = async () => {\n    if (!signatureRequest) return;\n\n    setIsLoading(true);\n\n    try {\n      console.log('‚úçÔ∏è ÂºÄÂßãÁ≠æÂêçÊµÅÁ®ã...');\n      \n      // ‰ΩøÁî®MetaMaskËøõË°åÁ≠æÂêç\n      if (typeof window.ethereum === 'undefined') {\n        throw new Error('MetaMaskÊú™ÂÆâË£Ö');\n      }\n\n      // ÊûÑÂª∫‰∫§ÊòìÊï∞ÊçÆ\n      const transactionData = {\n        to: signatureRequest.to_address,\n        value: signatureRequest.value || '0x0',\n        data: signatureRequest.data || '0x',\n        gas: signatureRequest.gas_limit || '0x186A0', // 100000 gas\n        gasPrice: signatureRequest.gas_price || '0x3B9ACA00' // 1 gwei\n      };\n\n      console.log('üìù ‰∫§ÊòìÊï∞ÊçÆ:', transactionData);\n\n      // ËØ∑Ê±ÇÁî®Êà∑Á≠æÂêç\n      const signature = await window.ethereum.request({\n        method: 'eth_sendTransaction',\n        params: [transactionData]\n      });\n\n      console.log('‚úÖ ‰∫§ÊòìÁ≠æÂêçÊàêÂäü:', signature);\n      \n      // Êèê‰∫§Á≠æÂêçÂà∞ÂêéÁ´Ø\n      const result = await submitSignature(currentSession.session_id, signature);\n      \n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'system',\n        content: '‚úÖ Á≠æÂêçÂ∑≤Êèê‰∫§Ôºå‰∫§ÊòìÊ≠£Âú®Â§ÑÁêÜ‰∏≠...',\n        timestamp: new Date()\n      }]);\n\n      // ËΩÆËØ¢‰∫§ÊòìÁä∂ÊÄÅ\n      let pollCount = 0;\n      const maxPolls = 20;\n      \n      while (pollCount < maxPolls) {\n        const status = await pollWorkflowStatus(currentSession.session_id);\n        pollCount++;\n        \n        console.log(`üìä Á¨¨${pollCount}Ê¨°ËΩÆËØ¢‰∫§ÊòìÁä∂ÊÄÅ:`, status);\n        \n        if (status.status === 'completed') {\n          setMessages(prev => [...prev, {\n            id: Date.now() + 1,\n            type: 'system',\n            content: `üéâ ‰∫§ÊòìÂÆåÊàêÔºÅ‰∫§ÊòìÂìàÂ∏å: ${signature}`,\n            timestamp: new Date()\n          }]);\n          break;\n        } else if (status.status === 'failed') {\n          setMessages(prev => [...prev, {\n            id: Date.now() + 1,\n            type: 'error',\n            content: `‚ùå ‰∫§ÊòìÂ§±Ë¥•: ${status.error || 'Êú™Áü•ÈîôËØØ'}`,\n            timestamp: new Date()\n          }]);\n          break;\n        }\n        \n        // Á≠âÂæÖ3ÁßíÂêéÁªßÁª≠ËΩÆËØ¢\n        await new Promise(resolve => setTimeout(resolve, 3000));\n      }\n\n      setSignatureRequest(null);\n      setCurrentSession(null);\n\n    } catch (error) {\n      console.error('‚ùå Á≠æÂêçÂ§±Ë¥•:', error);\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'error',\n        content: `‚ùå Á≠æÂêçÂ§±Ë¥•: ${error.message}`,\n        timestamp: new Date()\n      }]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleConnectWallet = async () => {\n    try {\n      await connectWallet();\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'system',\n        content: `üîó Èí±ÂåÖËøûÊé•ÊàêÂäüÔºÅÂú∞ÂùÄ: ${walletAddress}`,\n        timestamp: new Date()\n      }]);\n    } catch (error) {\n      setMessages(prev => [...prev, {\n        id: Date.now(),\n        type: 'error',\n        content: `‚ùå Èí±ÂåÖËøûÊé•Â§±Ë¥•: ${error.message}`,\n        timestamp: new Date()\n      }]);\n    }\n  };\n\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  return (\n    <div className=\"app\">\n      <div className=\"header\">\n        <h1>ü§ñ QNG Êô∫ËÉΩ‰Ωì</h1>\n        <div className=\"wallet-info\">\n          {walletConnected ? (\n            <span className=\"connected\">\n              üîó {walletAddress.slice(0, 6)}...{walletAddress.slice(-4)}\n            </span>\n          ) : (\n            <button \n              className=\"connect-btn\"\n              onClick={handleConnectWallet}\n              disabled={isLoading}\n            >\n              üîó ËøûÊé•Èí±ÂåÖ\n            </button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"chat-container\">\n        <div className=\"messages\">\n          {messages.map((message) => (\n            <div key={message.id} className={`message ${message.type}`}>\n              <div className=\"message-content\">\n                {message.content}\n              </div>\n              <div className=\"message-time\">\n                {message.timestamp.toLocaleTimeString()}\n              </div>\n            </div>\n          ))}\n          {isLoading && (\n            <div className=\"message system\">\n              <div className=\"message-content\">\n                <div className=\"loading\">\n                  <span>‚è≥</span>\n                  <span>Â§ÑÁêÜ‰∏≠</span>\n                  <span>...</span>\n                </div>\n              </div>\n            </div>\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n\n        {signatureRequest && (\n          <div className=\"signature-request\">\n            <h3>‚úçÔ∏è ‰∫§ÊòìÁ≠æÂêçËØ∑Ê±Ç</h3>\n            <div className=\"signature-details\">\n              <p><strong>Êìç‰Ωú:</strong> {signatureRequest.action}</p>\n              <p><strong>‰ªé:</strong> {signatureRequest.from_token}</p>\n              <p><strong>Âà∞:</strong> {signatureRequest.to_token}</p>\n              <p><strong>Êï∞Èáè:</strong> {signatureRequest.amount}</p>\n              <p><strong>GasË¥π:</strong> {signatureRequest.gas_fee}</p>\n              <p><strong>ÊªëÁÇπ:</strong> {signatureRequest.slippage}</p>\n            </div>\n            <button \n              className=\"signature-btn\"\n              onClick={handleSignature}\n              disabled={isLoading}\n            >\n              üîê Á°ÆËÆ§Á≠æÂêç\n            </button>\n          </div>\n        )}\n\n        <div className=\"input-container\">\n          <textarea\n            value={inputMessage}\n            onChange={(e) => setInputMessage(e.target.value)}\n            onKeyPress={handleKeyPress}\n            placeholder=\"ËæìÂÖ•ÊÇ®ÁöÑËØ∑Ê±ÇÔºå‰æãÂ¶ÇÔºöÊàëÈúÄË¶ÅÂ∞Ü1000USDTÂÖëÊç¢ÊàêBTC\"\n            disabled={isLoading}\n          />\n          <button \n            onClick={handleSendMessage}\n            disabled={isLoading || !inputMessage.trim()}\n            className=\"send-btn\"\n          >\n            ÂèëÈÄÅ\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}